!function(){function t(e,n,r){var i=t.resolve(e);if(null==i){r=r||e,n=n||"root";var o=new Error('Failed to require "'+r+'" from "'+n+'"');throw o.path=r,o.parent=n,o.require=!0,o}var s=t.modules[i];if(!s._resolving&&!s.exports){var a={};a.exports={},a.client=a.component=!0,s._resolving=!0,s.call(this,a.exports,t,a),delete s._resolving,s.exports=a.exports}return s.exports}t.modules={},t.aliases={},t.resolve=function(e){"/"===e.charAt(0)&&(e=e.slice(1));for(var n=[e,e+".js",e+".json",e+"/index.js",e+"/index.json"],r=0;r<n.length;r++){var e=n[r];if(t.modules.hasOwnProperty(e))return e;if(t.aliases.hasOwnProperty(e))return t.aliases[e]}},t.normalize=function(t,e){var n=[];if("."!=e.charAt(0))return e;t=t.split("/"),e=e.split("/");for(var r=0;r<e.length;++r)".."==e[r]?t.pop():"."!=e[r]&&""!=e[r]&&n.push(e[r]);return t.concat(n).join("/")},t.register=function(e,n){t.modules[e]=n},t.register("event",function(t){t.bind=function(t,e,n,r){return t.addEventListener?t.addEventListener(e,n,r||!1):t.attachEvent("on"+e,n),n},t.unbind=function(t,e,n,r){return t.removeEventListener?t.removeEventListener(e,n,r||!1):t.detachEvent("on"+e,n),n}}),t.register("measure",function(t,e,n){var r=function(t){return this.el=t,this},i={"padding-top":"paddingTop","padding-bottom":"paddingBottom","padding-left":"paddingLeft","padding-right":"paddingRight","border-top-width":"borderTopWidth","border-left-width":"borderLeftWidth","border-right-width":"borderRightWidth","border-bottom-width":"borderBottomWidth","margin-top":"marginTop","margin-left":"marginLeft","margin-right":"marginRight","margin-bottom":"marginBottom"},o=function(t,e){var n;return e.currentStyle?n=parseInt(e.currentStyle[i[t]].replace("px",""),10):window.getComputedStyle&&(n=parseInt(document.defaultView.getComputedStyle(e,null).getPropertyValue(t).replace("px",""),10)),n},s=function(t){var e={},n={},r={};return e.top=o("padding-top",t),e.right=o("padding-right",t),e.bottom=o("padding-bottom",t),e.left=o("padding-left",t),r.top=o("margin-top",t),r.right=o("margin-right",t),r.bottom=o("margin-bottom",t),r.left=o("margin-left",t),n.top=o("border-top-width",t),n.right=o("border-right-width",t),n.bottom=o("border-bottom-width",t),n.left=o("border-left-width",t),{padding:e,border:n,margin:r}};r.prototype={pagePosition:function(){var t=0,e=0,n=this.el,r=this.boxDetails().margin;if(n.offsetParent){do t+=n.offsetLeft,e+=n.offsetTop;while(n=n.offsetParent);return t-=r.left,e-=r.top,{x:t,y:e}}},innerPosition:function(){var t=this.boxDetails().margin,e=t.left,n=t.top,r=0,i=0;return r+=el.offsetLeft-e,i+=el.offsetTop-n,{x:r,y:i}},boxDetails:function(){return s(this.el)},innerSize:function(){var t=this.el,e=s(t),n=e.padding,r=e.border,i=n.left+n.right+r.left+r.right,o=n.top+n.bottom+r.top+r.bottom,a=0,u=0;return a=Math.max(el.clientWidth,el.offsetWidth)-i,u=Math.max(el.clientHeight,el.offsetHeight)-o,{x:a,y:u}},outerSize:function(){var t=0,e=0,n=this.el;return t=Math.max(n.clientWidth,n.offsetWidth),e=Math.max(n.clientHeight,n.offsetHeight),{x:t,y:e}},screenSize:function(){var t=window,e=document,n=e.documentElement,r=e.getElementsByTagName("body")[0],i=t.innerWidth||n.clientWidth||r.clientWidth,o=t.innerHeight||n.clientHeight||r.clientHeight;return{x:i,y:o}}},n.exports=function(t){return new r(t)}}),t.register("each",function(t,e,n){"use strict";var r=[].forEach;n.exports=function(t,e,n){if(null!=t)if(r&&t.forEach===r)t.forEach(e,n);else if(t.length===+t.length){for(var i=0,o=t.length;o>i;i++)if(e.call(n,t[i],i,t)==={})return}else for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e.call(n,t[s],s,t)==={})return}}),t.register("indexof",function(t,e,n){n.exports=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}}),t.register("hashchange",function(t,e,n){var r=e("each"),i=e("indexof"),o=function(t){var t=t||window.location.href;return t.replace(/^[^#]*#?(.*)$/,"$1")},s=function(){var t=-1;if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=n.exec(e)&&(t=parseFloat(RegExp.$1))}return 6===t||7===t?!0:!1},a=function(){var t=this;return this.onChangeCallbacks=[],s()?this.setupFallback():window.onhashchange=function(){t.hashChanged()},this};a.prototype={update:function(t){return t?(this.onChangeCallbacks.push(t),this):(this.hashChanged(),void 0)},unbind:function(t){var e=i(this.onChangeCallbacks,t);return-1!==e&&this.onChangeCallbacks.splice(e-1,1),this},updateHash:function(t){this.currentHash=t,window.location.href=window.location.href.replace(/#.*/,"")+"#"+t},hashChanged:function(){return this.onChangeCallbacks.length&&r(this.onChangeCallbacks,function(t){return t(o()),!0}),this},setupFallback:function(){var t=this;window.onload=function(){var e=-1,n=100,r=document.createElement("iframe");r.setAttribute("src","javascript:0"),r.style.display="none",document.getElementsByTagName("body")[0].appendChild(r),r=r.contentWindow;var i=function(t,e){if(t!==e){var n=r.document;n.open(),n.close(),n.location.hash="#"+t}},s=function(){return o(r.document.location.href)},a=o();i(a);var u=function(){var r=o(),c=s(a);r!==a?(i(a=r,c),t.hashChanged()):c!==a&&(window.location.href=window.location.href.replace(/#.*/,"")+"#"+c),e=setTimeout(u,n)};return setTimeout(u,n),this}}},hashChange=new a,n.exports=hashChange}),t.register("raf",function(t,e,n){function r(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-i)),r=setTimeout(t,n);return i=e,r}t=n.exports=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||r;var i=(new Date).getTime(),o=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout;t.cancel=function(t){o.call(window,t)}}),t.register("tick",function(t,e,n){var r,o=e("raf"),s=Date.now||function(){return(new Date).getTime()},a=s();window.performance&&window.performance.now?(r=function(){return performance.now()},a=performance.timing.navigationStart):r=function(){return s()-a};var u={},c=0,h=function(t){for(i in u)u.hasOwnProperty(i)&&u[i].update(t);return!0},f=function(){var t,e=this;return o(function(n){t=window.performance&&window.performance.now?n&&/\./.test(n.toString())?function i(t){h.call(e,t),o(i)}:function s(){h.call(e,performance.now()),o(s)}:function a(){h.call(e,r()),o(a)},o(t)}),this};f.prototype={add:function(){var t=function(t,e,n){var i,o=!1;return{update:function(r){o||t(r-e,n)},pause:function(){o=!0,i=r()},resume:function(){e=e+r()-i,o=!1},stop:n}};return function(e){var n=++c,i=function(){delete u[n]};return u[n]=t(e,r(),i),{id:n,stop:i,pause:u[n].pause,resume:u[n].resume}}}(),now:function(){return r()},pause:function(){for(i in u)u.hasOwnProperty(i)&&u[i].pause()},resume:function(){for(i in u)u.hasOwnProperty(i)&&u[i].resume()},stop:function(){for(i in u)u.hasOwnProperty(i)&&u[i].stop()}};var l=new f;n.exports=l}),t.register("page-visibility",function(t,e,n){var r=function(){var t=(document.body,this),e="hidden";this.callbacks={visible:[],hidden:[]};var n=function(){document[e]?t.isHidden():t.isVisible()},r=function(t){document.addEventListener(t+"visibilitychange",n)},i=function(t){return t in document?(e=t,!0):!1};i("hidden")?r(""):i("mozHidden")?r("moz"):i("webkitHidden")?r("webkit"):i("msHidden")?r("ms"):"onfocusin"in document?(document.onfocusin=function(){t.isVisible()},document.onfocusout=function(){t.isHidden()}):(window.onfocus=function(){t.isVisible()},window.onblur=function(){t.isHidden()})};r.prototype={isVisible:function(){for(var t=0,e=this.callbacks.visible.length;e>t&&this.callbacks.visible[t++]()!==!1;);return this},isHidden:function(){for(var t=0,e=this.callbacks.hidden.length;e>t&&this.callbacks.hidden[t++]()!==!1;);return this},onVisible:function(t){return this.callbacks.visible.push(t),this},onHidden:function(t){return this.callbacks.hidden.push(t),this}},pageVis=new r,n.exports=pageVis}),t.register("classes",function(t,e,n){function r(t){if(!t)throw new Error("A DOM element reference is required");this.el=t,this.list=t.classList}var i=e("indexof"),o=/\s+/,s=Object.prototype.toString;n.exports=function(t){return new r(t)},r.prototype.add=function(t){if(this.list)return this.list.add(t),this;var e=this.array(),n=i(e,t);return~n||e.push(t),this.el.className=e.join(" "),this},r.prototype.remove=function(t){if("[object RegExp]"==s.call(t))return this.removeMatching(t);if(this.list)return this.list.remove(t),this;var e=this.array(),n=i(e,t);return~n&&e.splice(n,1),this.el.className=e.join(" "),this},r.prototype.removeMatching=function(t){for(var e=this.array(),n=0;n<e.length;n++)t.test(e[n])&&this.remove(e[n]);return this},r.prototype.toggle=function(t){return this.list?(this.list.toggle(t),this):(this.has(t)?this.remove(t):this.add(t),this)},r.prototype.array=function(){var t=this.el.className.replace(/^\s+|\s+$/g,""),e=t.split(o);return""===e[0]&&e.shift(),e},r.prototype.has=r.prototype.contains=function(t){return this.list?this.list.contains(t):!!~i(this.array(),t)}}),t.register("dollar",function(t,e,n){var r=e("each"),i=e("classes"),o=e("event"),s="",a=function(t){return t&&(this[0]=t,this.length=1),this};a.prototype={length:0,selector:"",create:function(t){return this[0]=document.createElement(t),this},getById:function(t){return this[0]=document.getElementById(t),this[0]&&(this.length=1),this},getHead:function(){return this[0]=document.getElementsByTagName("head")[0],this[0]&&(this.length=1),this},getBody:function(){return this[0]=document.getElementsByTagName("body")[0],this[0]&&(this.length=1),this},attr:function(t,e){return this[0].setAttribute(t,e),this},appendTo:function(t){return t[0].appendChild(this[0]),this},append:function(t){return this[0].appendChild(t[0]),this},text:function(t){var e,n=this;return this[0].childNodes.length>0&&r(this[0].childNodes,function(t){3===t.nodeType&&n[0].removeChild(t)}),e=document.createTextNode(t),this[0].appendChild(e),this},addClass:function(t){return i(this[0]).add(t),this},removeClass:function(t){return i(this[0]).remove(t),this},hasClass:function(t){return i(this[0]).has(t)},toggleClass:function(t){return i(this[0]).toggle(t),this},css:function(t){var e=this;return r(t,function(t,n){"number"==typeof t&&(t+="px"),e[0].style[n]=t}),this},hide:function(){return s=this[0].style.display,this[0].style.display="none",this[0].style.visibility="hidden",this},show:function(){return this[0].style.display=s,this[0].style.visibility="visible",this},toggle:function(){return"none"===this[0].style.display||"hidden"===this[0].style.visibility?this.show():this.hide(),this},onClick:function(t){return o.bind(this[0],"click",function(e){var n=!1;return e.preventDefault||(e.preventDefault=function(){n=!0}),t(e),n?!1:void 0}),this},bind:function(t,e){return o.bind(this[0],t,function(t){var n=!1;return t.preventDefault||(t.preventDefault=function(){n=!0}),e(t),n?!1:void 0}),this},unbind:function(t,e){return o.unbind(this[0],t,e),this}},n.exports=function(t){return new a(t)}}),t.register("lzw",function(t,e,n){var r={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",compressToBase64:function(t){var e,n,r,i,o,s,a,u="",c=0;for(t=this.compress(t);c<2*t.length;)0==c%2?(e=t.charCodeAt(c/2)>>8,n=255&t.charCodeAt(c/2),r=c/2+1<t.length?t.charCodeAt(c/2+1)>>8:0/0):(e=255&t.charCodeAt((c-1)/2),(c+1)/2<t.length?(n=t.charCodeAt((c+1)/2)>>8,r=255&t.charCodeAt((c+1)/2)):n=r=0/0),c+=3,i=e>>2,o=(3&e)<<4|n>>4,s=(15&n)<<2|r>>6,a=63&r,isNaN(n)?s=a=64:isNaN(r)&&(a=64),u=u+this._keyStr.charAt(i)+this._keyStr.charAt(o)+this._keyStr.charAt(s)+this._keyStr.charAt(a);return u},decompressFromBase64:function(t){var e,n,r,i,o,s,a,u,c="",h=0,f=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");f<t.length;)o=this._keyStr.indexOf(t.charAt(f++)),s=this._keyStr.indexOf(t.charAt(f++)),a=this._keyStr.indexOf(t.charAt(f++)),u=this._keyStr.indexOf(t.charAt(f++)),n=o<<2|s>>4,r=(15&s)<<4|a>>2,i=(3&a)<<6|u,0==h%2?(e=n<<8,flush=!0,64!=a&&(c+=String.fromCharCode(e|r),flush=!1),64!=u&&(e=i<<8,flush=!0)):(c+=String.fromCharCode(e|n),flush=!1,64!=a&&(e=r<<8,flush=!0),64!=u&&(c+=String.fromCharCode(e|i),flush=!1)),h+=3;return this.decompress(c)},compressToUTF16:function(t){var e,n,r,i="",o=0;for(t=this.compress(t),e=0;e<t.length;e++)switch(n=t.charCodeAt(e),o++){case 0:i+=String.fromCharCode((n>>1)+32),r=(1&n)<<14;break;case 1:i+=String.fromCharCode(r+(n>>2)+32),r=(3&n)<<13;break;case 2:i+=String.fromCharCode(r+(n>>3)+32),r=(7&n)<<12;break;case 3:i+=String.fromCharCode(r+(n>>4)+32),r=(15&n)<<11;break;case 4:i+=String.fromCharCode(r+(n>>5)+32),r=(31&n)<<10;break;case 5:i+=String.fromCharCode(r+(n>>6)+32),r=(63&n)<<9;break;case 6:i+=String.fromCharCode(r+(n>>7)+32),r=(127&n)<<8;break;case 7:i+=String.fromCharCode(r+(n>>8)+32),r=(255&n)<<7;break;case 8:i+=String.fromCharCode(r+(n>>9)+32),r=(511&n)<<6;break;case 9:i+=String.fromCharCode(r+(n>>10)+32),r=(1023&n)<<5;break;case 10:i+=String.fromCharCode(r+(n>>11)+32),r=(2047&n)<<4;break;case 11:i+=String.fromCharCode(r+(n>>12)+32),r=(4095&n)<<3;break;case 12:i+=String.fromCharCode(r+(n>>13)+32),r=(8191&n)<<2;break;case 13:i+=String.fromCharCode(r+(n>>14)+32),r=(16383&n)<<1;break;case 14:i+=String.fromCharCode(r+(n>>15)+32,(32767&n)+32),o=0}return i+String.fromCharCode(r+32)},decompressFromUTF16:function(t){for(var e,n,r="",i=0,o=0;o<t.length;){switch(n=t.charCodeAt(o)-32,i++){case 0:e=n<<1;break;case 1:r+=String.fromCharCode(e|n>>14),e=(16383&n)<<2;break;case 2:r+=String.fromCharCode(e|n>>13),e=(8191&n)<<3;break;case 3:r+=String.fromCharCode(e|n>>12),e=(4095&n)<<4;break;case 4:r+=String.fromCharCode(e|n>>11),e=(2047&n)<<5;break;case 5:r+=String.fromCharCode(e|n>>10),e=(1023&n)<<6;break;case 6:r+=String.fromCharCode(e|n>>9),e=(511&n)<<7;break;case 7:r+=String.fromCharCode(e|n>>8),e=(255&n)<<8;break;case 8:r+=String.fromCharCode(e|n>>7),e=(127&n)<<9;break;case 9:r+=String.fromCharCode(e|n>>6),e=(63&n)<<10;break;case 10:r+=String.fromCharCode(e|n>>5),e=(31&n)<<11;break;case 11:r+=String.fromCharCode(e|n>>4),e=(15&n)<<12;break;case 12:r+=String.fromCharCode(e|n>>3),e=(7&n)<<13;break;case 13:r+=String.fromCharCode(e|n>>2),e=(3&n)<<14;break;case 14:r+=String.fromCharCode(e|n>>1),e=(1&n)<<15;break;case 15:r+=String.fromCharCode(e|n),i=0}o++}return this.decompress(r)},compress:function(t){var e,n,r,i={},o={},s="",a="",u="",c=2,h=3,f=2,l="",d=0,p=0;for(r=0;r<t.length;r+=1)if(s=t.charAt(r),i.hasOwnProperty(s)||(i[s]=h++,o[s]=!0),a=u+s,i.hasOwnProperty(a))u=a;else{if(o.hasOwnProperty(u)){if(u.charCodeAt(0)<256){for(e=0;f>e;e++)d<<=1,15==p?(p=0,l+=String.fromCharCode(d),d=0):p++;for(n=u.charCodeAt(0),e=0;8>e;e++)d=d<<1|1&n,15==p?(p=0,l+=String.fromCharCode(d),d=0):p++,n>>=1}else{for(n=1,e=0;f>e;e++)d=d<<1|n,15==p?(p=0,l+=String.fromCharCode(d),d=0):p++,n=0;for(n=u.charCodeAt(0),e=0;16>e;e++)d=d<<1|1&n,15==p?(p=0,l+=String.fromCharCode(d),d=0):p++,n>>=1}c--,0==c&&(c=Math.pow(2,f),f++),delete o[u]}else for(n=i[u],e=0;f>e;e++)d=d<<1|1&n,15==p?(p=0,l+=String.fromCharCode(d),d=0):p++,n>>=1;c--,0==c&&(c=Math.pow(2,f),f++),i[a]=h++,u=String(s)}if(""!==u){if(o.hasOwnProperty(u)){if(u.charCodeAt(0)<256){for(e=0;f>e;e++)d<<=1,15==p?(p=0,l+=String.fromCharCode(d),d=0):p++;for(n=u.charCodeAt(0),e=0;8>e;e++)d=d<<1|1&n,15==p?(p=0,l+=String.fromCharCode(d),d=0):p++,n>>=1}else{for(n=1,e=0;f>e;e++)d=d<<1|n,15==p?(p=0,l+=String.fromCharCode(d),d=0):p++,n=0;for(n=u.charCodeAt(0),e=0;16>e;e++)d=d<<1|1&n,15==p?(p=0,l+=String.fromCharCode(d),d=0):p++,n>>=1}c--,0==c&&(c=Math.pow(2,f),f++),delete o[u]}else for(n=i[u],e=0;f>e;e++)d=d<<1|1&n,15==p?(p=0,l+=String.fromCharCode(d),d=0):p++,n>>=1;c--,0==c&&(c=Math.pow(2,f),f++)}for(n=2,e=0;f>e;e++)d=d<<1|1&n,15==p?(p=0,l+=String.fromCharCode(d),d=0):p++,n>>=1;for(;;){if(d<<=1,15==p){l+=String.fromCharCode(d);break}p++}return l},decompress:function(t){var e,n,r,i,o,s,a,u,c=[],h=4,f=4,l=3,d="",p="",m=0,g={string:t,val:t.charCodeAt(0),position:32768,index:1};for(n=0;3>n;n+=1)c[n]=n;for(i=0,s=Math.pow(2,2),a=1;a!=s;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=32768,g.val=g.string.charCodeAt(g.index++)),i|=(o>0?1:0)*a,a<<=1;switch(e=i){case 0:for(i=0,s=Math.pow(2,8),a=1;a!=s;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=32768,g.val=g.string.charCodeAt(g.index++)),i|=(o>0?1:0)*a,a<<=1;u=String.fromCharCode(i);break;case 1:for(i=0,s=Math.pow(2,16),a=1;a!=s;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=32768,g.val=g.string.charCodeAt(g.index++)),i|=(o>0?1:0)*a,a<<=1;u=String.fromCharCode(i);break;case 2:return""}for(c[3]=u,r=p=u;;){for(i=0,s=Math.pow(2,l),a=1;a!=s;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=32768,g.val=g.string.charCodeAt(g.index++)),i|=(o>0?1:0)*a,a<<=1;switch(u=i){case 0:if(m++>1e4)return"Error";for(i=0,s=Math.pow(2,8),a=1;a!=s;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=32768,g.val=g.string.charCodeAt(g.index++)),i|=(o>0?1:0)*a,a<<=1;c[f++]=String.fromCharCode(i),u=f-1,h--;break;case 1:for(i=0,s=Math.pow(2,16),a=1;a!=s;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=32768,g.val=g.string.charCodeAt(g.index++)),i|=(o>0?1:0)*a,a<<=1;c[f++]=String.fromCharCode(i),u=f-1,h--;break;case 2:return p}if(0==h&&(h=Math.pow(2,l),l++),c[u])d=c[u];else{if(u!==f)return null;d=r+r.charAt(0)}p+=d,c[f++]=r+d.charAt(0),h--,r=d,0==h&&(h=Math.pow(2,l),l++)}return p}};n.exports=r}),t.register("notebutton",function(t,e,n){var r=e("dollar"),i=function(t){var e=this;return this.on=!1,this.element=r().create("li").addClass("note"),this.element.bind("click",function(){e.element.toggleClass("on"),e.on=!e.on,e.element.removeClass("unqueued").removeClass("queued"),t()}),this};i.prototype={resize:function(t){return this.size=t,this.element.css({width:t-2,height:t-2}),this},move:function(t,e){return this.element.css({left:t,top:e}),this},addClass:function(t){return this.element.addClass(t),this},removeClass:function(t){return this.element.removeClass(t),this},toggleClass:function(t){return this.element.toggleClass(t),this},appendTo:function(t){return this.element.appendTo(t),this}},n.exports.NoteButton=function(t,e){return new i(t,e)}}),t.register("monome-synth",function(t,e,n){var r,i=e("dollar"),o=(e("measure"),e("lzw")),s=(e("event"),e("notebutton").NoteButton),a=e("voice").Voice,u=[1244.51,1108.73,932.33,830.61,740,622.25,554.37,466.16,415.3,370,311.13,277.18,233.08,207.65,185,155.56,138.59,116.54,103.83,92.5],c=e("voice").SINE,h=function(t,e,n,o){var h=this;r=t,e=e,n=n,this.bpm=n,this.rows=[],this.voices=[],window.rows=this.rows,this.oscillators=[],this.container=i().create("ul").addClass("monome"),i().getBody().append(this.container);for(var f=0;16>f;f++){var l=[];this.rows.push(l);var d=a(r,e);d.setBPM(n),d.frequency(u[f+4]),d.waveform(c),this.voices.push(d);var p=i().create("ul");p.addClass("col");for(var m=0;16>m;m++){var g=s(function(){h.updateCode()});g.appendTo(p),l.push(g)}this.container.append(p)}var v=15;return this.nextTime=r.currentTime+n,o.add(function(){var t=r.currentTime;if(t>h.nextTime){h.nextTime-t+.1;for(var e=0;16>e;e++)h.rows[v%16][e].removeClass("sweep");v++;for(var i=0,e=0;16>e;e++)h.rows[v%16][e].addClass("sweep"),h.rows[v%16][e].on===!0&&i++;for(var e=0;16>e;e++)h.rows[v%16][e].on===!0&&(h.voices[e].gain(.15*Math.cos((1-1/i)*(1/i)*Math.PI)).play(h.nextTime+.1),h.rows[v%16][e].removeClass("queued")),h.rows[(v+1)%16][e].on===!0&&h.rows[(v+1)%16][e].addClass("queued");h.nextTime=h.nextTime+n}}),this};h.prototype={updateCode:function(t){if(t)return this.sendNewCode=t,this;for(var e="",n=0;16>n;n++)for(var r=0;16>r;r++)e+=this.rows[n][r].on?"1":"0";this.sendNewCode&&this.sendNewCode(o.compressToBase64(e))},useCode:function(t){for(var e=o.decompressFromBase64(t),n=this,r=0;16>r;r++)for(var i=0;16>i;i++)n.rows[r][i].on=1===parseInt(e.substr(i+16*r,1),2)?!0:!1,n.rows[r][i].on?n.rows[r][i].addClass("on"):n.rows[r][i].removeClass("on");return this},resize:function(t){for(var e=Math.floor(t.y/16),n=0;16>n;n++)for(var r=0;16>r;r++)this.rows[n][r].resize(Math.floor(.9*e)).move(n*e,r*e);return this},move:function(t){return this.container.css({position:"absolute",top:t.y,left:t.x}),this},waveform:function(t){for(var e=0;16>e;e++)this.voices[e].waveform(t);return this},glide:function(){for(var t=0;16>t;t++)this.voices[t].toggleGlide();return this},stop:function(){return this.voices.forEach(function(t){t.stop()}),this},resume:function(){return this.nextTime=r.currentTime+this.bpm,this}},n.exports.Monome=function(t,e,n,r){return new h(t,e,n,r)}}),t.register("easing",function(t,e,n){var r=e("bezier"),i={ease:[.25,.1,.25,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1],linear:[0,0,1,1],"ease-in-out-back":[.45,-.42,.595,1.34],"ease-out-back":[.62,1.255,.665,1.095],"ease-in-back":[.33,-.305,.715,-.155],"ease-out-expo":[.015,.745,.225,.985],"ease-in-expo":[.775,0,.975,.075],"ease-in-cubic":[.6,.02,.95,.295],"ease-out-cubic":[.075,.61,.36,.93]},o=function(){return this};o.prototype={using:function(t){var e,n=this;if(e=i[t])return n.curve=r({c1:[0,0],c4:[1,1],c2:[e[0],e[1]],c3:[e[2],e[3]]}).buildLookup(),function(t){return n.curve.findYAtX(t)};throw new Error("No such preset!")},usingCustomCurve:function(t){var e=this;return e.curve=r(t),function(t){return e.curve.yAtTime(t)}},usingCSS3Curve:function(t,e,n,i){var o=this;return o.curve=r({c1:[0,0],c2:[t,e],c3:[n,i],c4:[1,1]}).buildLookup(),function(t){return o.curve.findYAtX(t)}}},n.exports.Ease=function(){return new o},n.exports.isPreset=function(t){return!0},n.exports.presets=function(){var t=[];for(var e in i)i.hasOwnProperty(e)&&t.push(e);return t}()}),t.register("is",function(t,e,n){"use strict";var r=e("each"),i=Object.prototype.toString,o=["Arguments","Function","String","Number","Date","RegExp","Array"];r(o,function(t){n.exports[t.toLowerCase()]=function(e){return i.call(e)==="[object "+t+"]"}}),Array.isArray&&(n.exports.array=Array.isArray),n.exports.object=function(t){return t===Object(t)}}),t.register("parse-duration",function(t,e,n){var r=e("is"),i=function(t){if(r.number(t))return t;if(r.string(t)){var e;return e=t.match(/([0-9]+)s/),e&&e[1]?1e3*parseInt(e[1],10):(e=t.match(/([0-9]+)ms/),e&&e[1]?parseInt(e[1],10):(e=t.match(/([0-9]+)m/),e&&e[1]?60*1e3*parseInt(e[1],10):(e=t.match(/([0-9]+)h/),e&&e[1]?60*60*1e3*parseInt(e[1],10):(e=t.match(/([0-9]+)d/),e&&e[1]?24*60*60*1e3*parseInt(e[1],10):(e=t.match(/([0-9]+)w/),e&&e[1]?7*24*60*60*1e3*parseInt(e[1],10):0)))))}throw new Error("Invalid duration")};n.exports=function(t){return i(t)}}),t.register("color-parser",function(t,e,n){function r(t){return a(t)||s(t)||i(t)||o(t)}function i(t){if(0==t.indexOf("rgb(")){t=t.match(/rgb\(([^)]+)\)/)[1];var e=t.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}}function o(t){if(0==t.indexOf("rgba(")){t=t.match(/rgba\(([^)]+)\)/)[1];var e=t.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:e[3]}}}function s(t){return"#"==t[0]&&7==t.length?{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:1}:void 0}function a(t){return"#"==t[0]&&4==t.length?{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:1}:void 0}n.exports=r}),t.register("binary-search",function(t,e,n){n.exports=function(t,e){var n=function r(n,i){if(n>i)return[i,!1];if(t[n]===e)return[n,!0];if(t[i]===e)return[i,!0];var o=Math.floor((n+i)/2),s=t[o];return s>e?r(n+1,o):e>s?r(o,i-1):[o,!0]};return n(0,t.length-1)}}),t.register("bezier",function(t,e,n){var r=e("binary-search"),i=function(t,e){var n=1-t;return n*this._c1[e]+t*this._c2[e]},o=function(t,e){var n=1-t;return this._c1[e]*n*n+this._c2[e]*2*n*t+this._c3[e]*t*t},s=function(t,e){var n=1-t;return this._c1[e]*n*n*n+this._c2[e]*3*n*n*t+this._c3[e]*3*n*t*t+this._c4[e]*t*t*t},a=function(t){if(!t)var t={};return this._c1=t.c1||[0,0],this._c2=t.c2||[0,0],this._c3=t.c3||[0,0],this._c4=t.c4||[0,0],this.isCubic(),this},u=function(t){if("undefined"!=typeof t.top&&"undefined"!=typeof t.left)return[t.left,t.top];if("undefined"!=typeof t.x&&"undefined"!=typeof t.y)return[t.x,t.y];if("number"==typeof t[0]&&"number"==typeof t[1])return t;throw new Error("Input unacceptable")};a.prototype={c1:function(t){return this._c1=u(t),this},c2:function(t){return this._c2=u(t),this},c3:function(t){return this._c3=u(t),this},c4:function(t){return this._c4=u(t),this},isLinear:function(){var t=this;return this.b=function(e,n){return i.call(t,e,n)},this},isQuadratic:function(){var t=this;return this.b=function(e,n){return o.call(t,e,n)},this},isCubic:function(){var t=this;return this.b=function(e,n){return s.call(t,e,n)},this},point:function(t){var e=this;return{x:e.b(t,0),y:e.b(t,1)}},pointCss:function(t){var e=this;return{left:e.b(t,0),top:e.b(t,1)}},renderToCanvas:function(t){t.beginPath(),t.moveTo(this._c1[0],this._c1[1]),t.bezierCurveTo(this._c2[0],this._c2[1],this._c3[0],this._c3[1],this._c4[0],this._c4[1]),t.stroke()},pointArray:function(t){return[this.b(t,0),this.b(t,1)]},xAtTime:function(t){return this.b(t,0)},yAtTime:function(t){return this.b(t,1)},buildLookup:function(t){for(var e,n=this._x=[],r=this._y=[],i=t||1e4,o=0;i>o;o++)e=o/i,n.push(this.xAtTime(e)),r.push(this.yAtTime(e));return this},findYAtX:function(t){return 1===t?this.yAtTime(1):0===t?this.yAtTime(0):this._y[r(this._x,t)[0]]},query:function(){return{c1:this._c1,c2:this._c2,c3:this._c3,c4:this._c4}}},n.exports=function(t,e,n,r){return new a(t,e,n,r)}}),t.register("tween",function(t,e,n){var r=e("easing").Ease,i=e("bezier"),o=e("is"),s=e("each"),a=e("color-parser"),u=e("parse-duration"),c=e("tick"),h=function(t){if(o.object(t))return t;if(o.string(t)){var e=a(t);if(e)return e;throw new Error("Invalid string input!")}return o.number(t)?{tween:t}:{tween:0}},f=function(){return"linear"===this._pathMode&&s(this.tweens,function(t){t.path=i().c1([0,t.start]).c2([0,t.end]).isLinear()}),!0},l=function(t){return this.tweens={},this._duration=1e3,this._easer=r().using("linear"),this._pathMode="linear",this.callbacks={tick:function(){},begin:function(){},finish:function(){}},this.from(t),this};l.prototype={from:function(t){var e=this,n=h(t);return s(n,function(t,n){e.tweens[n]={start:t,end:0}}),f.call(this),this},to:function(t){var e=this,n=h(t);return s(n,function(t,n){e.tweens[n]?e.tweens[n].end=t:e.tweens[n]={start:0,end:t}}),f.call(this),this},using:function(t){var n=this;if(o.string(t)){if(!e("easing").isPreset(t))throw new Error("Invalid easing");n._easer=r().using(t)}else if(o.array(t)&&4===t.length){var i=r();n._easer=i.usingCSS3Curve.apply(i,t)}else{if(!(o.object(t)&&o.array(t.c1)&&o.array(t.c2)&&o.array(t.c3)&&o.array(t.c4)))throw new Error("Invalid easing");n._easer=r().usingCustomCurve(t)}return this},duration:function(t){return t&&(this._duration=u(t)),this},tick:function(t){return this.callbacks.tick=t,this},begin:function(t){return this.callbacks.begin=t,this},finish:function(t){return this.callbacks.finish=t,this},query:function(){return{easer:this._easer,duration:this._duration,tweens:this.tweens}},valueAtTime:function(t){var e={},n=this._easer(t);return this.tweens&&s(this.tweens,function(t,r){e[r]=t.path.yAtTime(n)}),e},play:function(){var t=this;return t.stopped=!1,t.handle=c.add(function(e,n){var r=Math.min(1,e/t._duration);t.stopped||t.callbacks.tick(t.valueAtTime(r)),1===r&&(n(),t.callbacks.finish(c.now()))}),t.callbacks.begin(c.now()),this},stop:function(){var t=this;return t.stopped=!0,t.handle&&t.handle.stop(),this}},n.exports.Tweening=function(t){return new l(t)}}),t.register("voice",function(t,e,n){var r,i=function(t,e){return r=t,this.bpm=.5,this.filter=r.createBiquadFilter(),this.masterVolume=r.createGain(),this.envelope=r.createGain(),this.osc=r.createOscillator(),this.masterVolume.connect(e),this.filter.connect(this.masterVolume),this.envelope.connect(this.filter),this.osc.connect(this.envelope),this.masterVolume.gain.value=0,this.envelope.gain.value=0,this.filter.type=0,this.filter.Q.value=.5,this.rampUpTimeout=-1,this.rampDownTimeout=-1,this.doGlide=!1,this.osc.start(r.currentTime),this};i.prototype={play:function(t){var n=this.bpm;clearTimeout(this.rampDownTimeout),clearTimeout(this.rampUpTimeout),this.rampUp&&this.rampDown&&(this.rampDown.stop(),this.rampUp.stop());var i=function(t){o.envelope.gain.value=t.value},o=this,s=1e3*Math.floor(t-r.currentTime),i=function(t){o.envelope.gain.value=t.value};return this.rampUp=e("tween").Tweening({value:this.envelope.gain.value}).to({value:1}).using("ease-in").duration(Math.round(1e3*n/2)).tick(i),this.rampDown=e("tween").Tweening({value:1}).to({value:0}).using("ease-out").duration(Math.round(2*1e3*n)).tick(i),this.doGlide&&(this.glide=e("tween").Tweening({value:-600}).to({value:0}).using("linear").duration(Math.round(1e3*n/20)).tick(function(t){o.osc.detune.value=t.value})),this.rampUpTimeout=setTimeout(function(){o.rampUp.play(),o.doGlide&&o.glide.play()},s),this.rampDownTimeout=setTimeout(function(){o.rampDown.play()},s+Math.round(1e3*n)),this},gain:function(t){return this.masterVolume.gain.value=t,this},stop:function(){this.rampUp&&this.rampDown&&(this.rampUp.stop(),this.rampDown.stop(),clearTimeout(this.rampDownTimeout),clearTimeout(this.rampUpTimeout)),this.envelope.gain.value=0,this.rampUpTimeout=-1,this.rampDownTimeout=-1},square:function(){return this.osc.type=this.osc.SQUARE,this},triangle:function(){return this.osc.type=this.osc.TRIANGLE,this},ramp:function(){return this.osc.type=this.osc.SAWTOOTH,this},sine:function(){return this.osc.type=this.osc.SINE,this},waveform:function(t){return this.osc.type=t,this},frequency:function(t){return this.osc.frequency.value=t,this.filter.frequency.value=2*t,this},setBPM:function(t){return this.bpm=t,this},toggleGlide:function(){return this.doGlide=!0,this}},n.exports.Voice=function(t,e){return new i(t,e)},n.exports.SINE=0,n.exports.SQUARE=1,n.exports.SAWTOOTH=2,n.exports.TRIANGLE=3}),t.register("monome",function(t,e){var n=new webkitAudioContext,r=.2,i=n.createOscillator(),o=(e("voice").SINE,n.createChannelMerger(16)),s=n.createChannelMerger(16),a=e("page-visibility"),u=e("tick"),c=n.createGain(),h=n.createGain(),f=e("hashchange");c.gain.value=1,h.gain.value=1,i.connect(n.destination),o.connect(c),s.connect(h),c.connect(n.destination),h.connect(n.destination);var l="Aw18ZXTt/DFOS1b0dEA=",d="Aw18ZXTt/DFOS1b0dEA=",p=e("event"),m=e("measure"),g=function(t,e){var n=t.match(/<%=([A-Za-z0-9\-\_\.]+)%>/g);return n.forEach(function(n){var r=n.replace(/<%=/,"");r=r.replace(/%>/,""),e[r]&&(t=t.replace(n,e[r]))}),t},v={"ul.monome.a li.note":"-webkit-transition: -webkit-transform 0ms, background <%=sweep%>ms!important","ul.monome.a li.note.queued":"-webkit-transition: -webkit-transform <%=lifespan%>ms, box-shadow <%=lifespan%>ms","ul.monome.a li.note.sweep.on":"-webkit-transition: -webkit-transform <%=lifespan%>ms!important","ul.monome.b li.note.sweep.on":"-webkit-transition: -webkit-transform <%=lifespanB%>ms!important","ul.monome.b li.note.queued":"-webkit-transition: -webkit-transform <%=lifespanB%>ms, box-shadow <%=lifespan%>ms","ul.monome.a li.note.on":"-webkit-transition: background <%=lifespan%>ms, box-shadow <%=lifespan%>ms!important","ul.monome.b li.note.on":"-webkit-transition: background <%=lifespanB%>ms, box-shadow <%=lifespanB%>ms!important","ul.monome.b li.note":"-webkit-transition: -webkit-transform 0ms, background <%=sweep%>ms!important"},w={lifespan:.7*1e3*r,sweep:2*1e3*r,glow:1e3*r/2,lifespanB:.7*1e3*8*r,sweepB:2*1e3*8*r,glowB:1e3*8*r/2},b=document.styleSheets[document.styleSheets.length-1];for(var C in v)v.hasOwnProperty(C)&&b.insertRule(C+"{"+g(v[C],w)+"}",b.cssRules.length);var y=e("monome-synth").Monome(n,o,r,u).glide().updateCode(function(t){l=t,f.updateHash("!song="+l+":"+d)}),k=e("monome-synth").Monome(n,s,4*r,u).waveform(i.SAWTOOTH).updateCode(function(t){d=t,f.updateHash("!song="+l+":"+d)});y.container.addClass("a"),k.container.addClass("b");var x=function(){var t=m().screenSize(),e=Math.min(.8*t.x/2,.8*t.y);y.resize({x:e,y:e}).move({x:.05*t.x,y:.1*t.y}),k.resize({x:e,y:e}).move({x:t.x/2+.05*t.x,y:.1*t.y})
};p.bind(window,"resize",x),x(),f.update(function(t){if(""!==t&&t.match(/!song\=/)){var e=t.replace("!song=",""),n=e.split(":");1===n.length?(l=n[0],d=n[0]):(l=n[0],d=n[1]),y.useCode(l),k.useCode(d)}}).update(),a.onHidden(function(){u.pause(),y.stop(),k.stop()}),a.onVisible(function(){u.resume(),y.resume(),k.resume()})}),t("monome")}();